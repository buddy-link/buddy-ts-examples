(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{11922:function(){},71456:function(){},55024:function(){},73171:function(e,t,n){Promise.resolve().then(n.t.bind(n,38173,23)),Promise.resolve().then(n.t.bind(n,69531,23)),Promise.resolve().then(n.t.bind(n,53054,23)),Promise.resolve().then(n.bind(n,72861)),Promise.resolve().then(n.bind(n,66583)),Promise.resolve().then(n.bind(n,35475)),Promise.resolve().then(n.bind(n,44034)),Promise.resolve().then(n.bind(n,32507)),Promise.resolve().then(n.bind(n,28463)),Promise.resolve().then(n.bind(n,92563))},72861:function(e,t,n){"use strict";n.d(t,{default:function(){return N}});var s=n(57437),a=n(79347),i=n(89733),r=n(54662),l=n(98174),o=n(66648),c=n(2265),u=n(49354);let d=e=>e.length<=14?e:e.length>=14&&e.length<=20?e.substring(0,14)+"...":e.substring(0,4)+"..."+e.substring(e.length-4),h=e=>{let[t,n]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let s=window.matchMedia(e);s.matches!==t&&n(s.matches);let a=()=>n(s.matches);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[t,e]),t};var f=n(28782),g=n(98058),x=n(13304);let m=x.fC,p=x.xz,v=x.h_,j=x.x8,b=c.forwardRef((e,t)=>{let{className:n,children:a,...i}=e;return(0,s.jsx)(v,{children:(0,s.jsx)(x.VY,{ref:t,className:(0,u.cn)("fixed inset-0 z-50 flex h-full w-full max-w-full flex-col items-center justify-center  gap-4 bg-background p-5 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out   data-[state=closed]:slide-out-to-bottom-full  data-[state=open]:slide-in-from-bottom-full",n),...i,children:a})})});b.displayName=x.VY.displayName;var y=n(56511);function w(){let{publicKey:e}=(0,f.O)(),{walletSignIn:t}=(0,y.r)(),n=(0,c.useCallback)(async()=>{await t()},[t]);return(0,s.jsx)(i.z,{className:"animate-pulse",variant:"primary",onClick:n,disabled:!e,children:(0,s.jsx)("p",{children:"Sign Message"})})}let C=()=>{let{publicKey:e,wallet:t,disconnect:n}=(0,f.O)(),{setVisible:x}=(0,g.h)(),v=(0,l.kP)(),y=h("(min-width: 768px)"),C=(0,c.useMemo)(()=>{var t;return d(null!==(t=null==e?void 0:e.toBase58())&&void 0!==t?t:"")},[e]),N=(0,c.useCallback)(async()=>{await n(),await (0,l.w7)({redirect:!1})},[n]),k=(0,c.useCallback)(()=>{x(!0)},[x]);return t&&e?y&&"authenticated"===v.status?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.hg,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"primary",type:"button",className:"",onClick:k,children:"Change Wallet"})}),(0,s.jsx)(r.hg,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"primary",type:"button",className:"",onClick:N,children:"Logout"})})]}):y||"authenticated"!==v.status?e&&"unauthenticated"===v.status?(0,s.jsx)(w,{}):void 0:(0,s.jsxs)(m,{children:[(0,s.jsx)(p,{asChild:!0,children:(0,s.jsxs)(i.z,{variant:"outline",className:(0,u.cn)("group flex aspect-square size-9 items-center justify-center rounded-full"),children:[(0,s.jsx)(a.o,{}),(0,s.jsx)("span",{children:C})]})}),(0,s.jsxs)(b,{className:"flex flex-col items-center justify-start",children:[(0,s.jsx)(o.default,{src:"/logo.svg",alt:"logo",width:200,height:200,className:"mt-10"}),(0,s.jsx)("div",{className:"my-auto flex flex-col items-center justify-center gap-3",children:(0,s.jsx)("span",{className:"text-lg text-white",children:C})}),(0,s.jsxs)("div",{className:"my-auto flex w-full flex-col items-center justify-center gap-3",children:[(0,s.jsx)(j,{className:"p-0",asChild:!0,children:(0,s.jsx)(i.z,{variant:"outline",type:"button",className:"w-full outline-0 ring-0 hover:bg-primary  focus-visible:ring-0 focus-visible:ring-offset-0",onClick:N,children:"Logout"})}),(0,s.jsx)(j,{className:"p-0",asChild:!0,children:(0,s.jsx)(i.z,{variant:"outline",type:"button",className:"w-full outline-0 ring-0 hover:bg-primary  focus-visible:ring-0 focus-visible:ring-offset-0",onClick:k,children:"Change Wallet"})}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"outline",type:"button",className:"w-full outline-0 ring-0 hover:bg-primary  focus-visible:ring-0 focus-visible:ring-offset-0",children:"Close"})})]})]})]}):(0,s.jsx)(r.hg,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"primary",className:(0,u.cn)("group flex  items-center justify-center gap-3 border-0",!y&&"aspect-square  size-9 rounded-full p-2"),onClick:k,children:y?"Connect Wallet":(0,s.jsx)(a.o,{className:"h-5 w-5 "})})})};var N=()=>{var e,t,n,o;let h=(0,l.kP)(),x=(0,f.O)(),{setVisible:m}=(0,g.h)(),p=(0,c.useMemo)(()=>{var e,t,n,s,a;return d(null!==(a=null!==(s=null==h?void 0:null===(t=h.data)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.name)&&void 0!==s?s:null===(n=x.publicKey)||void 0===n?void 0:n.toBase58())&&void 0!==a?a:"")},[null==h?void 0:null===(t=h.data)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.name,x.publicKey]),v=(0,c.useMemo)(()=>"authenticated"===h.status,[null==h?void 0:h.status]),j=(0,c.useCallback)(async()=>{await x.disconnect(),await (0,l.w7)({redirect:!1}),m(!0)},[m,x]),b=(0,c.useCallback)(async()=>{await x.disconnect(),await (0,l.w7)({redirect:!1})},[x]);return console.log("session: ",h),(0,s.jsxs)(r.Vq,{children:[(0,s.jsx)(r.hg,{asChild:!0,children:(0,s.jsx)(i.z,{type:"button",variant:"primary",className:"gap-2 px-6 py-4",children:(null==h?void 0:h.status)==="loading"||x.connecting?"loading...":v?v&&(null===(o=h.data)||void 0===o?void 0:null===(n=o.user)||void 0===n?void 0:n.name)&&(0,s.jsxs)("div",{className:"flex gap-2 items-center justify-center",children:[(0,s.jsx)(a.o,{className:"fill-white h-4 w-4"}),(0,s.jsx)("span",{className:"mt-[1px]",children:p})]}):"Connect"})}),(0,s.jsxs)(r.cZ,{className:"max-w-xs",children:[(0,s.jsx)(r.fK,{children:(0,s.jsx)(r.$N,{className:(0,u.cn)("font-bold",v?"text-2xl":"text-5xl"),children:v?p:"Login"})}),v?(0,s.jsxs)("div",{className:"flex flex-col  justify-center py-6 gap-4 px-6",children:[(0,s.jsx)(r.GG,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"primary",type:"button",className:"",onClick:j,children:"Change Wallet"})}),(0,s.jsx)(r.GG,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"primary",className:"text-white gap-2 px-6 py-4",onClick:b,children:"Logout"})})]}):(0,s.jsxs)("div",{className:"flex flex-col  justify-center py-6 gap-4 px-6",children:[(0,s.jsx)(C,{}),(null==h?void 0:h.status)==="unauthenticated"&&(0,s.jsx)(i.z,{variant:"primary",className:"text-white gap-2 px-6 py-4",onClick:()=>(0,l.zB)("google"),children:"Sign In with Google"})]}),(0,s.jsx)(r.cN,{children:(0,s.jsx)(r.GG,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"primary",children:"Close"})})})]})]})}},66583:function(e,t,n){"use strict";n.d(t,{Toaster:function(){return r}});var s=n(57437),a=n(79512),i=n(27776);let r=e=>{let{...t}=e,{theme:n="system"}=(0,a.F)();return(0,s.jsx)(i.x,{theme:n,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})}},56511:function(e,t,n){"use strict";n.d(t,{r:function(){return u}});var s=n(28782),a=n(42126),i=n(98174),r=n(2265),l=n(77085),o=n(46124),c=n(27776);let u=()=>{let{publicKey:e,signMessage:t,wallet:n}=(0,s.O)();return{walletSignIn:(0,r.useCallback)(async()=>{try{if(!e)throw Error("Wallet not connected!");if(!t)throw Error("Wallet does not support message signing!");let n=(await a.Z.get("/api/auth/createNonce")).data.nonce,s=new TextEncoder().encode("Sign this message: ".concat(n)),r=await t(s);if(!l.sign.detached.verify(s,r,e.toBytes()))throw Error("Invalid signature!");console.log("aqui"),await (0,i.zB)("credentials",{redirect:!1,publicKey:e,signature:o.encode(r)})}catch(e){(0,c.A)("Signing failed:",{description:null==e?void 0:e.message,action:{label:"Undo",onClick:()=>console.log("Undo")}})}},[e,t])}}},35475:function(e,t,n){"use strict";let s;n.d(t,{default:function(){return l}});var a=n(57437),i=n(8699),r=n(93191);function l(e){let{children:t}=e,n=(s||(s=new i.S({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1}}})),s);return(0,a.jsx)(r.aH,{client:n,children:t})}},44034:function(e,t,n){"use strict";var s=n(57437),a=n(98174);t.default=e=>{let{children:t}=e;return(0,s.jsx)(a.eA,{children:t})}},32507:function(e,t,n){"use strict";var s=n(57437),a=n(56511),i=n(28782),r=n(98174),l=n(2265);t.default=()=>{let{publicKey:e}=(0,i.O)(),{walletSignIn:t}=(0,a.r)(),n=(0,r.kP)();return(0,l.useEffect)(()=>{if(n&&"loading"!==n.status){if("unauthenticated"===n.status&&e){t();return}return()=>{}}},[n,e,t]),(0,s.jsx)(s.Fragment,{})}},28463:function(e,t,n){"use strict";n.d(t,{S:function(){return w},UserProvider:function(){return y}});var s=n(57437),a=n(2265),i=n(98174),r=n(15297),l=n(71519),o=n(48270),c=n(32580),u=n(19212),d=n.n(u),h=n(42126),f=n(93375),g=n(25566),x=e=>{let{googleToken:t,setState:n}=e,s=(0,i.kP)(),u=(0,a.useCallback)(async()=>{if("authenticated"!==s.status||!t.jwt)return;let e=t.jwt;if(d()(1e3*t.exp).unix()<d()().unix()){let n=await (0,h.Z)({method:"POST",url:"/api/auth/refresh-token",data:{token:t.refreshToken}});n.data.token&&(e=n.data.token,(0,f.setCookie)("google_token",JSON.stringify({...t,jwt:n.data.token,exp:d()().add(1,"hour").unix()}),{secure:!0}))}let a=(0,r.s)({identityPoolId:"us-east-1:75e05cbb-f317-4042-b2ba-640624734e63",clientConfig:{region:"us-east-1"},logins:{"accounts.google.com":e}}),i=new l.Q({region:"us-east-1",credentials:a}),{IdentityId:u}=await i.send(new o.n({IdentityPoolId:"us-east-1:75e05cbb-f317-4042-b2ba-640624734e63",AccountId:g.env.NEXT_PUBLIC_AWS_ACCOUNT_ID,Logins:{"accounts.google.com":e}})),{Credentials:x}=await i.send(new c.L({IdentityId:u,Logins:{"accounts.google.com":e}}));void 0!==x&&n(e=>({...e,credentials:x}))},[t,s.status]);return(0,a.useEffect)(()=>{u()},[u]),null},m=n(55355),p=n(36225);let v=h.Z.create();var j=()=>{let e=(0,a.useContext)(w);return(0,a.useEffect)(()=>{e.credentials&&v.interceptors.request.use(async t=>(null===e.credentials||(0,p.ZP)({options:{service:"execute-api",region:"us-east-1"},credentials:{accessKeyId:e.credentials.AccessKeyId,secretAccessKey:e.credentials.SecretKey,sessionToken:e.credentials.SessionToken}})(t),t))},[e.credentials]),v},b=e=>{let t=j();return{user:(0,m.a)({queryKey:["user"],queryFn:()=>t.get("".concat("https://9tsjebxsmd.execute-api.us-east-1.amazonaws.com","/user")).then(e=>e.data),enabled:e})}};let y=e=>{let{children:t,googleToken:n}=e,r=(0,i.kP)(),[l,o]=(0,a.useState)({credentials:null,isAuthenticated:!1,user:null}),{user:c}=b("authenticated"===r.status&&null!==l.credentials);return(x({googleToken:n,setState:o}),(0,a.useEffect)(()=>{o(e=>c.data?{...e,user:c.data}:e)},[c.data]),"loading"===r.status)?(0,s.jsx)("div",{children:"Loading..."}):(0,s.jsx)(w.Provider,{value:l,children:t})},w=(0,a.createContext)({isAuthenticated:!1,credentials:null,user:null})},92563:function(e,t,n){"use strict";n.d(t,{WalletConnectionProvider:function(){return u}});var s=n(57437),a=n(2265),i=n(91910),r=n(11325),l=n(65442),o=n(78457),c=n(45429);n(35438);let u=e=>{let{children:t}=e,n=l.Q.Mainnet,u=(0,a.useMemo)(()=>(0,c.Wf)(n),[n]),d=(0,a.useMemo)(()=>[],[n]);return(0,s.jsx)(i.U,{endpoint:u,children:(0,s.jsx)(r.n,{wallets:d,autoConnect:!0,children:(0,s.jsx)(o.s,{children:t})})})}},53054:function(){}},function(e){e.O(0,[533,218,990,814,952,713,203,805,971,23,744],function(){return e(e.s=73171)}),_N_E=e.O()}]);